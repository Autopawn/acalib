% This is the aspauthor.tex LaTeX file
% Copyright 2014, Astronomical Society of the Pacific Conference Series
% Revision:  14 August 2014

% To compile, at the command line positioned at this folder, type:
% latex aspauthor
% latex aspauthor
% dvipdfm aspauthor
% This will create a file called aspauthor.pdf.

\documentclass[11pt,twoside]{article}
\usepackage{./asp2014}

\aspSuppressVolSlug
\resetcounters

\bibliographystyle{asp2014}

\markboth{Araya, Solar, Mardones, et al.}{The ChiVO Library}

\begin{document}

\title{The ChiVO Library: advanced computational methods for astronomy}
\author{Mauricio~Araya$^1$, Mauricio~Solar$^1$, Diego Mardones$^2$, Luis
Arevalo$^1$, Marcelo Mendoza$^1$,Camilo Valenzuela$^{1}$,
Teodoro Hochf\"arber$^{1}$, Mart\'in Villanueva$^{1}$, Marcelo Jara $^{1}$, and Axel
Simonsen$^{1}$}
\affil{$^1$Universidad T\'ecnica Federico Santa Mar\'ia, Valpara\'iso, chile;
\email{nombre.apellido@usm.cl}}
\affil{$^2$Universidad de Chile, Santiago, Chile; \email{dmardones@uchile.cl}}

% This section is for ADS Processing.  There must be one line per author.
\paperauthor{Mauricio Araya}{mauricio.araya@usm.cl}{}{Universidad T\'ecnica
Federico Santa María}{Departamento de Informática}{Valparaíso}{}{}{Chile}
\paperauthor{Mauricio Solar}{mauricio.solar@usm.cl}{}{Universidad T\'ecnica
Federico Santa María}{Departamento de Informática}{Santiago}{}{}{Chile}
\paperauthor{Diego Mardones}{}{}{Universidad de Chile}{Departamento de
Astronomía}{Santiago}{}{}{Chile}
\paperauthor{Marcelo Mendoza}{marcelo.mendoza@usm.cl}{}{Universidad T\'ecnica
Federico Santa María}{Departamento de Informática}{Santiago}{}{}{Chile}
\paperauthor{Camilo Valenzuela}{cvalenzuela@csrg.cl}{}{Universidad T\'ecnica
Federico Santa María}{Departamento de Informática/CSRG}{Valparaíso}{}{}{Chile}
\paperauthor{Teodoro Hochf\"arber}{teohoch@csrg.cl}{}{Universidad T\'ecnica
Federico Santa María}{Departamento de Informática/CSRG}{Valparaíso}{}{}{Chile}
\paperauthor{Mart\'in Villanueva}{mvillan@csrg.cl}{}{Universidad T\'ecnica
Federico Santa María}{Departamento de Informática/CSRG}{Valparaíso}{}{}{Chile}
\paperauthor{Marcelo Jara}{mjara@csrg.cl}{}{Universidad T\'ecnica
Federico Santa María}{Departamento de Informática/CSRG}{Valparaíso}{}{}{Chile}
\paperauthor{Axel Simonsen}{axel.simonsen@alumnos.usm.cl}{}{Universidad T\'ecnica
Federico Santa María}{Departamento de Informática/CSRG}{Valparaíso}{}{}{Chile}

\begin{abstract}
The main objective of the Advanced Computational Astronomy Library (ACALib) is
to ensemble a coherent software package with the research on computational
methods for astronomy performed by the first phase of the Chilean Virtual
Observatory between years 2013 and 2015. During this period, researchers and
students developed functional prototypes, implementing state of the art
computational methods and proposing new algorithms and techniques. This
research was mainly focused on spectroscopic data cubes, as they strongly
require computational methods to reduce, visualize and infer astrophysical
quantities from them, and because most of the techniques are directly applicable
either to images or to spectra.

The ACALib philosophy is to use a persistent workspace abstraction where
spectroscopic data cubes can be loaded from files, created from other cubes or
artificially generated from astrophysical parameters. Then, computational
methods can be applied to them, resulting in new data cube instances or new data
tables in the workspace. The idea is to provide not only API bindings for the
workspace and the cubes, but also web-services to use the library in cloud-based
frameworks and in the Virtual Observatory.

In a nutshell, ACALib is integrating and testing several cube manipulation
routines, stacking procedures, structure detection algorithms, spectral line
association techniques and a synthetic data cube generation module. The library
is developed in python, strongly rooted in astropy modules and using efficient
numerical libraries such as numpy and scipy, and machine learning libraries like
scikitlearn and astroML.

In the near future, we plan to propose ACALib as an astropy affiliated package,
and to create a CASA add-on to ease the usage of our methods. Also, we are
exploring bleeding-edge computational methods to include to ACALib, such as deep
learning networks, and developing new prototypes for other types of astronomical
data, such as light curves in the time-domain.
\end{abstract}

\section{Overview}
ACALib is a software package that implements several algorithms and
tools for analyzing spectroscopic data cubes, images and spectra. The library
consist in a coherent framework for developing novel webservices for
processing data on-line in the Chilean Virtual Observatory
(\cite{solar2014spie}), but it also
offers a generic API for developing stand-alone applications. The algorithms
automatically connects to VO services (\cite{araya2015survey}), and the library is compatible with the
SAMP protocol for interacting with other applications like Topcat or Aladin
(see Figure~\ref{fig1}:left).

%\articlefigure[width=.3\textwidth]{img/acageneral.eps}{fig1}{Interactions of ACALib with other

The library is divided into 5 modules. The \emph{core} module has the main
classes that represent and manipulate astronomical data. The \emph{VO} module
provides the workspace abstraction and VO communication interfaces.
The \emph{synthetic} module generates synthetic data (spectral lines, flux
distributions, meta-data, etc). The \emph{process} module contains the
algorithms developed so far by ChiVO. At last, the \emph{graphic} module
will have the widgets and tools for 3D visualization of
spectroscopic cubes, clumps, surfaces, spectra, etc. 

The rest of the paper describes these modules which were (or are been) developed
reusing as much as possible from existing libraries.
Indeed, the library is strongly based on Astropy (\cite{astropy}) and uses vectorized
computations through numpy and advanced algorithms from scipy and scikit-learn.

\articlefigurethree{img/acageneral}{img/acacore.eps}{img/acaprocess.eps}{fig1}{
Module views of ACALib. Through the paper,
the boxes in yellow are those components that are already implemented and
integrated, the green ones are the ones that are already prototyped, but not
integrated, and in blue/cyan are those that are currently under development.
\emph{Left:} Interactions of ACALib with other software. 
\emph{Center:} Core module abstract data types. \emph{Right:} Algorithms of the process
module and data structures.}

\section{Modules}

\subsection{Core Module}

This module contains the abstract data types that are used by all the other
modules. \texttt{AData} is an extension of astropy NDData class, that uses vectorized masked arrays
for storing data, allowing fast computations with missing values support. It
inherits metadata and WCS support, and adds several methods like 
rotate, scale, slice, stack, statistics, search, etc.
It also implements transactions in order to maintain consistency of WCS and
metadata, either using a deferred or online updates.
\textbf{ATable} is an extension of astropy Table, that provides a simpler
interface to fill it and provide some basic statistics
(see Figure~\ref{fig1}:center).

\textbf{AContainer} is an aggregator class composed by a list of AData and
ATable objects. It works as a namespace for astronomical data, and allows to
load and save FITS files (also a data container).
We plan to build a \textbf{AHierarchicalContainer}, which will be a tree of 
AContainer objects for supporting the HDF5 format

\subsection{Process Module}

The Algorithms implemented so far are:
\begin{itemize}
\item \textbf{Clumping}: detect clumps in an AData. Similar to CUPID package
(\cite{CupidAdass}).
\begin{itemize}
\item GaussClumps: Mixture of Gaussians fitting (\cite{stutzki90})
%\\ (Stutzki \& Gusten, 1990, ApJ)
\item FellWalker: Agregation of hill-climbing paths (\cite{berry2015}) %%\\ (Berry, 2015, A\&C)
\item BubbleClumps: Clustering of small Gaussians (unpublished) %%\\ (in preparation) (OA)
\end{itemize}
\item \textbf{ROI Detection}: index multi-resolution regions of interest in an
AData.
\begin{itemize}
\item StructDetect: Morphological processing (\cite{mendoza2015}) %%\\ (Mendoza et al., 2015, A\&C) [2]
\item WaveletDetect: Multi-scale detection in Wavelets space
(\cite{gregorio2014spie}) 
%%\\ (Gregorio et %%al., 2015, SPIE) 
\end{itemize}
\item DISPLAY: Learn dictionaries for line detection (unpublished) a %% \\(Riveros, 2015, Thesis)
\item SpeLAR: Compute association rules for spectral lines (unpublished) %%\\ (Miranda, 2015,
%%Thesis) (OA)
\item Stacking: Automatic stacking of images (unpublished) %% \\ (Jara, 2015, Thesis) (OA)
\end{itemize}

In Figure~\ref{fig1}:right a summary of the input/output data types of the
algorithms can be found.


\subsection{Other Implemented Modules}

Due to space constraints we do not include a detailed description or diagrams of the other
modules. The \textbf{VO} module implements a workspace abstraction, which is a class that host elements of the core
(AContainer, AData and ATable), send them
through SAMP and obtain/export data from/to the VO. Also, it allows loading and
saving the whole workspace to disk.

The \textbf{synthetic} module is an integrated version of ASYDO (refer to
\cite{araya2015exorcising}), which can generate data for testing, training and validation.

\section{Future Work}

Currently, we are working in the \textbf{graphic} module. 
This is a key module to validate the results of each algorithm,
specifically by offering volumetric visualization of spectroscopic
data cubes.

We also are exploring the performance details of the library for
implementing the required services in our Data Centre.
Specifically, a Cython  integration for less memory consumption than NumPy
and an MPI  integration for speeding up automatic pipelines are undergoing.

In terms of algorithms, we are still integrating the prototyped algorithms
(green), but in parallel we are investigation how to denoise of images using
deep autoencoders 
and implementing machine learning algorithms for long-term variable stars
detection.

\clearpage % To force this stuff to happen by this point in the text, otherwise these will probably end up after the references.

\acknowledgements This work was partially financed by CONICYT through the FONDEF D11I1060 project and the ICHAA 79130008 project. 

\bibliography{article}  % For BibTex

% For non-BibTex:
%\begin{thebibliography}{}
%\bibitem[Barnes (2008)]{ex_1}
%The first reference.  This reference may span the width of the page and should be in the format described in the instructions.
%\bibitem[Barnes (2009)]{ex_2}
%The second reference.  This reference may also span the width of the page and should be in the format described in the instructions.
%\bibitem[Barnes (2010)]{ex_3}
%The third reference.  If there is a URL in here make sure to put it in the right way.\\
%See {\footnotesize \url{http://www.somewhere.com/see_there's%still_characters_here}}
%\end{thebibliography}

\end{document}
